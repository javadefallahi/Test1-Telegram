<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1, user-scalable=no"
    />
    <title>ToyBox 3D – Mobile</title>

    <!-- Google <model-viewer> web component -->
    <script
      type="module"
      src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"
    ></script>

    <style>
      /* ——— Design tokens ——— */
      :root {
        --brand: #6366f1;
        --bg: #f0f2f7;
        --card: #ffffff;
        --radius: 1rem;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica,
          Arial, sans-serif;
      }

      @media (prefers-color-scheme: dark) {
        :root {
          --bg: #1a1a1a;
          --card: #2a2a2a;
          --brand: #8183ff;
          color-scheme: dark;
          color: #f4f4f4;
        }
      }

      /* ——— Reset & helpers ——— */
      * {
        box-sizing: border-box;
        -webkit-tap-highlight-color: transparent;
      }

      body {
        margin: 0;
        background: var(--bg);
        display: flex;
        flex-direction: column;
        min-height: 100vh;
      }

      /* ——— Layout wrapper ——— */
      #app {
        flex: 1 1 auto;
        display: flex;
        flex-direction: column;
        gap: 0.75rem;
        padding: 0.75rem;
      }

      /* ——— 3‑D viewer ——— */
      #viewer-container {
        background: var(--card);
        border-radius: var(--radius);
        overflow: hidden;
        position: relative;
        width: 100%;
      }

      model-viewer {
        width: 100%;
        height: 60vh; /* keep a comfortable portion of phone screen */
        --poster-color: var(--bg);
      }

      #toyOverlay {
        position: absolute;
        top: 50%;
        left: 50%;
        width: 80px;
        height: 80px;
        transform: translate(-50%, -50%);
        pointer-events: none;
        display: none;
      }

      /* ——— Controls ——— */
      #controls {
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
      }

      label {
        font-weight: 600;
        font-size: 0.9rem;
      }

      select,
      input[type="color"],
      button,
      a.checkout {
        font: inherit;
        border: 2px solid var(--brand);
        background: var(--card);
        padding: 0.55rem 0.8rem;
        border-radius: 0.75rem;
        cursor: pointer;
        transition: background 0.2s;
      }

      button:hover,
      select:hover,
      input[type="color"]:hover,
      a.checkout:hover {
        background: var(--brand);
        color: #fff;
      }

      #toy-store {
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
      }

      #toy-store button {
        flex: 1 1 45%; /* two buttons per row on small screens */
      }

      a.checkout {
        text-align: center;
        text-decoration: none;
        font-weight: 700;
        margin-top: 0.5rem;
      }
    </style>
  </head>
  <body>
    <div id="app">
      <!-- ——— 3D Viewer ——— -->
      <div id="viewer-container">
        <model-viewer
          id="modelViewer"
          src="https://modelviewer.dev/shared-assets/models/Astronaut.glb"
          alt="3D character"
          camera-controls
          auto-rotate
          shadow-intensity="1"
          ar
        ></model-viewer>
        <img id="toyOverlay" src="" alt="Toy overlay" />
      </div>

      <!-- ——— UI Controls ——— -->
      <div id="controls">
        <!-- ① Character selection -->
        <label for="modelSelect">Character</label>
        <select id="modelSelect">
          <option value="astro">Astronaut</option>
          <option value="robot">Expressive Robot</option>
        </select>

        <!-- ② Background color picker -->
        <label for="bgPicker">Background</label>
        <input type="color" id="bgPicker" value="#f0f2f7" />

        <!-- ③ Toy store -->
        <label>Toys</label>
        <div id="toy-store"></div>

        <!-- ④ Checkout -->
        <a class="checkout" href="https://www.zarinpal.com/" target="_blank"
          >Checkout ↗</a
        >
      </div>
    </div>

    <script>
      /* ——— Data ——— */
      const MODELS = {
        astro: "https://modelviewer.dev/shared-assets/models/Astronaut.glb",
        robot: "https://modelviewer.dev/shared-assets/models/RobotExpressive.glb",
      };

      const TOYS = [
        {
          id: "star",
          name: "Golden Star",
          preview:
            "https://raw.githubusercontent.com/iconic/open-iconic/master/png/star-8x.png",
        },
        {
          id: "ball",
          name: "Bouncy Ball",
          preview: "https://i.imgur.com/NtWPrPs.png",
        },
        {
          id: "hat",
          name: "Wizard Hat",
          preview: "https://i.imgur.com/xyobkOD.png",
        },
      ];

      /* ——— Element refs ——— */
      const modelViewer = document.getElementById("modelViewer");
      const modelSelect = document.getElementById("modelSelect");
      const bgPicker = document.getElementById("bgPicker");
      const viewerContainer = document.getElementById("viewer-container");
      const toyStore = document.getElementById("toy-store");
      const toyOverlay = document.getElementById("toyOverlay");

      /* ——— Init toy buttons ——— */
      TOYS.forEach((toy) => {
        const btn = document.createElement("button");
        btn.textContent = toy.name;
        btn.addEventListener("click", () => {
          toyOverlay.src = toy.preview;
          toyOverlay.style.display = "block";
        });
        toyStore.appendChild(btn);
      });

      /* ——— Listeners ——— */
      modelSelect.addEventListener("change", (e) => {
        const key = e.target.value;
        modelViewer.src = MODELS[key];
      });

      bgPicker.addEventListener("input", (e) => {
        viewerContainer.style.background = e.target.value;
      });
    </script>
  </body>
</html>
